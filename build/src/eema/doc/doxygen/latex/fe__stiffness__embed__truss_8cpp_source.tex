\hypertarget{fe__stiffness__embed__truss_8cpp_source}{}\section{fe\+\_\+stiffness\+\_\+embed\+\_\+truss.\+cpp}
\label{fe__stiffness__embed__truss_8cpp_source}\index{src/eema/src/\+Elements/\+Internal\+Nodal\+Force/fe\+\_\+stiffness\+\_\+embed\+\_\+truss.\+cpp@{src/eema/src/\+Elements/\+Internal\+Nodal\+Force/fe\+\_\+stiffness\+\_\+embed\+\_\+truss.\+cpp}}

\begin{DoxyCode}
00001 
00002 \textcolor{preprocessor}{#include"\hyperlink{functions_8h}{functions.h}"}
00003 
00004 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00005 
\Hypertarget{fe__stiffness__embed__truss_8cpp_source_l00006}\hyperlink{fe__stiffness__embed__truss_8cpp_ab3798340a27f0972299b3820aab0ccba}{00006} MatrixXd \hyperlink{fe__stiffness__embed__truss_8cpp_ab3798340a27f0972299b3820aab0ccba}{fe\_stiffness\_embed\_truss}(MatrixXd nodes\_truss, MatrixXd elements\_truss, \textcolor{keywordtype}{
      double} E\_truss, \textcolor{keywordtype}{double} A\_truss, \textcolor{keywordtype}{int} \hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof}, \textcolor{keywordtype}{int} nnel, \textcolor{keywordtype}{int} edof, \textcolor{keywordtype}{double} xcoord[], \textcolor{keywordtype}{double} ycoord[], \textcolor{keywordtype}{double} 
      zcoord[])\{
00007 
00008     MatrixXd disp\_mat(6,edof);
00009 
00010     VectorXd shapes\_3d(edof);
00011     VectorXd dndr(edof);    
00012     VectorXd dnds(edof);
00013     VectorXd dndt(edof);
00014     VectorXd dndx(edof);    
00015     VectorXd dndy(edof);
00016     VectorXd dndz(edof);
00017     MatrixXd jacobian(edof,edof);
00018     MatrixXd invJacobian(edof,edof);
00019 
00020     MatrixXd strain\_transform\_mat = \hyperlink{functions_8h_aa41c40dffea4251a07a8a3f5062f47ae}{fe\_calTransformation}(nodes\_truss,2);
00021 
00022     MatrixXd k\_truss(edof,edof);
00023     k\_truss = MatrixXd::Zero(edof,edof);
00024 
00025     MatrixXd k\_correction(edof,edof);
00026     k\_correction = MatrixXd::Zero(edof,edof);
00027     
00028     \textcolor{keywordtype}{double} length = 1;
00029     \textcolor{keywordtype}{int} truss\_intg = 2;
00030     MatrixXd nodes\_intg\_global(2,3);
00031     VectorXd nodes\_intg\_local(3);
00032     \textcolor{comment}{//VectorXd truss\_origin(3); // for local to global transformation}
00033     \textcolor{comment}{//truss\_origin << nodes\_truss(0,1), nodes\_truss(0,2), nodes\_truss(0,3);}
00034     VectorXd truss\_intg\_points = \hyperlink{functions_8h_aa6ab8c3298fa10734e299fe8266aed35}{guass\_points}(2);
00035     VectorXd truss\_intg\_weights = \hyperlink{functions_8h_a84dcc9575e861bdb2872c10ba6238ee4}{guass\_weights}(2);
00036 
00037     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<truss\_intg;i++)\{
00038         \textcolor{keywordtype}{double} t = truss\_intg\_points(i);
00039         \textcolor{comment}{//std::cout<<t<<"is t\(\backslash\)n";}
00040         \textcolor{keywordtype}{double} wtt = truss\_intg\_weights(i);
00041         \textcolor{comment}{//std::cout<<wtt<<"is the weight\(\backslash\)n";    }
00042         nodes\_intg\_local << t, 0, 0;
00043         MatrixXd tmp(3,3);
00044         tmp = \hyperlink{functions_8h_ae2eeba997bf4f0bc4749b92130de7ba3}{fe\_calSimpTransformation}(nodes\_truss);
00045         \textcolor{comment}{//nodes\_intg\_global.row(i) = truss\_origin + (tmp.transpose()*nodes\_intg\_local);}
00046         nodes\_intg\_global.row(i) = (tmp.transpose()*nodes\_intg\_local);
00047         \textcolor{comment}{//nodes\_intg\_global.row(i) = }
00048         
00049         \textcolor{comment}{// Calculating the Parent Strain Displacement Matrix at embedded node positions}
00050         \textcolor{comment}{//dndr = fe\_dndr\_8(nodes\_intg\_global(i,0),nodes\_intg\_global(i,1),nodes\_intg\_global(i,2));}
00051         \textcolor{comment}{//dnds = fe\_dnds\_8(nodes\_intg\_global(i,0),nodes\_intg\_global(i,1),nodes\_intg\_global(i,2));}
00052         \textcolor{comment}{//dndt = fe\_dndt\_8(nodes\_intg\_global(i,0),nodes\_intg\_global(i,1),nodes\_intg\_global(i,2));}
00053         dndr = \hyperlink{functions_8h_afc547bef246c057db6cbd04bf7f866a9}{fe\_dndr\_8}(0,0,t);
00054         \textcolor{comment}{//std::cout<<"DNDR is: "<<dndr<<"\(\backslash\)n";}
00055         dnds = \hyperlink{functions_8h_ac0b5524525e1f2e89bb064c15ab8e664}{fe\_dnds\_8}(0,0,t);
00056         dndt = \hyperlink{functions_8h_a57e8e5c9f740c98e4767f29c121c2d0a}{fe\_dndt\_8}(0,0,t);
00057         jacobian = \hyperlink{functions_8h_a5ae3771e65b4a0d177097041a4349c28}{fe\_calJacobian}(ndof,nnel,dndr,dnds,dndt,xcoord,ycoord,zcoord);
00058         \textcolor{comment}{//std::cout<<"JACOBIAN: "<<jacobian<<"\(\backslash\)n";}
00059                 invJacobian = jacobian.inverse();
00060         \textcolor{comment}{//std::cout<<"Inverse Jacobian: "<<invJacobian<<"\(\backslash\)n";}
00061                 dndx = \hyperlink{functions_8h_afc6be1a5667e68156cb099e8da71170f}{fe\_dndx\_8}(nnel, dndr, dnds, dndt, invJacobian);
00062         \textcolor{comment}{//std::cout<<"DNDX is: "<<dndx<<"\(\backslash\)n";}
00063                 dndy = \hyperlink{functions_8h_a0572d7818e085c67f7fbb84eef8ecfb4}{fe\_dndy\_8}(nnel, dndr, dnds, dndt, invJacobian);
00064                 dndz = \hyperlink{functions_8h_aaf75db8433433807839c6ea17f2cf72c}{fe\_dndz\_8}(nnel, dndr, dnds, dndt, invJacobian);
00065                 disp\_mat = \hyperlink{functions_8h_a4b49d2df4f86e7d0755971ab4bfa48b2}{fe\_strDispMatrix}(edof,nnel,dndx,dndy,dndz);
00066         \textcolor{comment}{//std::cout<<"Displacement Matrix is: "<<disp\_mat.transpose()<<"\(\backslash\)n";}
00067         \textcolor{comment}{//std::cout<<"Size of disp\_mat is:
       "<<disp\_mat.transpose().rows()<<"&"<<disp\_mat.transpose().cols()<<"\(\backslash\)n";}
00068         \textcolor{comment}{//std::cout<<"Size of strain\_mat is:
       "<<strain\_transform\_mat.transpose().rows()<<"&"<<strain\_transform\_mat.transpose().cols()<<"\(\backslash\)n";}
00069         \textcolor{comment}{//std::cout<<"Size of strain\_mat is:
       "<<strain\_transform\_mat.rows()<<"&"<<strain\_transform\_mat.cols()<<"\(\backslash\)n";}
00070 
00071         k\_truss = k\_truss + ((A\_truss)*(((disp\_mat.transpose()*strain\_transform\_mat.transpose())*E\_truss*
      strain\_transform\_mat)*disp\_mat)*(length/2)*(wtt));
00072         \textcolor{comment}{//k\_correction = k\_correction +
       (A\_truss*E*(((disp\_mat.transpose()*strain\_transform\_mat.transpose())*strain\_transform\_mat)*disp\_mat)*(length/2)*wtt);}
00073     \}   
00074     std::string truss\_stiffness\_file = \textcolor{stringliteral}{"result\_trussStiffness.txt"};
00075     \hyperlink{functions_8h_a346547477d2a1fbeff6b5e0b05314283}{matrix2text}(truss\_stiffness\_file.c\_str(),k\_truss,0);
00076 
00077     \textcolor{keywordflow}{return} k\_truss;
00078 \}
\end{DoxyCode}

\hypertarget{fe__newton_rhapson_8cpp_source}{}\section{fe\+\_\+newton\+Rhapson.\+cpp}
\label{fe__newton_rhapson_8cpp_source}\index{src/eema/src/\+Math/\+General\+Math/fe\+\_\+newton\+Rhapson.\+cpp@{src/eema/src/\+Math/\+General\+Math/fe\+\_\+newton\+Rhapson.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{functions_8h}{functions.h}"}
00002 
00003 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00004 
\Hypertarget{fe__newton_rhapson_8cpp_source_l00005}\hyperlink{fe__newton_rhapson_8cpp_ad3d80cd8d6370090eb6cc57a523bcd6c}{00005} \textcolor{keywordtype}{double} \hyperlink{fe__newton_rhapson_8cpp_ad3d80cd8d6370090eb6cc57a523bcd6c}{eps\_nr} = 1e-6; 
\Hypertarget{fe__newton_rhapson_8cpp_source_l00006}\hyperlink{fe__newton_rhapson_8cpp_a43f0d7a4e9f3ece65db80d07bb79192f}{00006} \textcolor{keywordtype}{double} \hyperlink{fe__newton_rhapson_8cpp_a43f0d7a4e9f3ece65db80d07bb79192f}{iterations\_nr} = 100;
00007 
\Hypertarget{fe__newton_rhapson_8cpp_source_l00010}\hyperlink{fe__newton_rhapson_8cpp_acdc9c3b5b3aecd9972c84d0cbb669978}{00010} VectorXd \hyperlink{fe__newton_rhapson_8cpp_acdc9c3b5b3aecd9972c84d0cbb669978}{fe\_newtonRhapson}(VectorXd nat\_coord, VectorXd xcoord, VectorXd ycoord, VectorXd 
      zcoord)\{
00011 
00012     VectorXd coord = VectorXd::Zero((nat\_coord.size())*(xcoord.size()));
00013     \textcolor{keywordtype}{int} nnel = xcoord.size();
00014     \textcolor{keywordtype}{double} eps = 1e6;
00015     \textcolor{keywordtype}{double} iterations = 1;
00016 
00017     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<nnel;i++)\{
00018         coord((i*3)) = xcoord(i);
00019         coord((i*3)+1) = ycoord(i);
00020         coord((i*3)+2) = zcoord(i);
00021     \}
00022 
00023     \textcolor{keywordtype}{double} edof = coord.size();
00024     VectorXd iso\_coord = VectorXd::Zero(3); 
00025     VectorXd iso\_coord\_new = VectorXd::Zero(3);
00026     VectorXd shapes;
00027 
00028     \textcolor{keywordflow}{if}(nnel==8)\{
00029         shapes = \hyperlink{functions_8h_ab77a3a6d6f6b436d7e8c600bb0869927}{fe\_shapes\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00030     \}
00031 
00032     MatrixXd shape\_mat = \hyperlink{functions_8h_a98fae74dde5fe33a7062e7457a2d3227}{fe\_shapeMatrix}(edof,nnel,shapes);
00033     VectorXd fx = VectorXd::Zero(3);
00034 
00035     VectorXd dndr;
00036     VectorXd dnds;
00037     VectorXd dndt;
00038     MatrixXd jacobian;
00039 
00040     dndr = \hyperlink{functions_8h_afc547bef246c057db6cbd04bf7f866a9}{fe\_dndr\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00041     dnds = \hyperlink{functions_8h_ac0b5524525e1f2e89bb064c15ab8e664}{fe\_dnds\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00042     dndt = \hyperlink{functions_8h_a57e8e5c9f740c98e4767f29c121c2d0a}{fe\_dndt\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00043     jacobian = \hyperlink{functions_8h_a5ae3771e65b4a0d177097041a4349c28}{fe\_calJacobian}(\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof},nnel,dndr,dnds,dndt,xcoord,ycoord,zcoord);
00044     MatrixXd transJacobian = jacobian.transpose();
00045     MatrixXd it\_Jacobian = transJacobian.inverse();
00046 
00047     fx = (nat\_coord - (shape\_mat*coord)); 
00048     
00049     \textcolor{keywordflow}{while}((eps>=\hyperlink{fe__newton_rhapson_8cpp_ad3d80cd8d6370090eb6cc57a523bcd6c}{eps\_nr})||(iterations>=\hyperlink{fe__newton_rhapson_8cpp_a43f0d7a4e9f3ece65db80d07bb79192f}{iterations\_nr}))\{
00050 
00051         iso\_coord\_new = iso\_coord + (it\_Jacobian*(fx));
00052         iso\_coord = iso\_coord\_new;
00053         
00054         shapes = \hyperlink{functions_8h_ab77a3a6d6f6b436d7e8c600bb0869927}{fe\_shapes\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00055         shape\_mat = \hyperlink{functions_8h_a98fae74dde5fe33a7062e7457a2d3227}{fe\_shapeMatrix}(edof,nnel,shapes);
00056         fx = (nat\_coord - (shape\_mat*coord)); 
00057 
00058         eps = fx.norm();
00059 
00060         dndr = \hyperlink{functions_8h_afc547bef246c057db6cbd04bf7f866a9}{fe\_dndr\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00061         dnds = \hyperlink{functions_8h_ac0b5524525e1f2e89bb064c15ab8e664}{fe\_dnds\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00062         dndt = \hyperlink{functions_8h_a57e8e5c9f740c98e4767f29c121c2d0a}{fe\_dndt\_8}(iso\_coord(0),iso\_coord(1),iso\_coord(2));
00063         jacobian = \hyperlink{functions_8h_a5ae3771e65b4a0d177097041a4349c28}{fe\_calJacobian}(\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof},nnel,dndr,dnds,dndt,xcoord,ycoord,zcoord);
00064         transJacobian = jacobian.transpose();
00065         it\_Jacobian = transJacobian.inverse(); 
00066 
00067         iterations = iterations+1;
00068 
00069     \}
00070 
00071     \textcolor{keywordflow}{return} iso\_coord;
00072 \}
\end{DoxyCode}

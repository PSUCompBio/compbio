\hypertarget{fe__ogden__hyperelastic_8cpp_source}{}\section{fe\+\_\+ogden\+\_\+hyperelastic.\+cpp}
\label{fe__ogden__hyperelastic_8cpp_source}\index{src/eema/src/\+Materials/\+Ogden-\/\+Hyperelastic/fe\+\_\+ogden\+\_\+hyperelastic.\+cpp@{src/eema/src/\+Materials/\+Ogden-\/\+Hyperelastic/fe\+\_\+ogden\+\_\+hyperelastic.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{functions_8h}{functions.h}"}
00002 
00003 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00004 
\Hypertarget{fe__ogden__hyperelastic_8cpp_source_l00005}\hyperlink{fe__ogden__hyperelastic_8cpp_ab27ecb703db33cb21a8a6d2fbfbf125f}{00005} VectorXd \hyperlink{fe__ogden__hyperelastic_8cpp_ab27ecb703db33cb21a8a6d2fbfbf125f}{fe\_ogden\_hyperelastic}(VectorXd dndx, VectorXd dndy, VectorXd dndz, VectorXd u
      , \textcolor{keywordtype}{int} opt, \textcolor{keywordtype}{int} return\_opt)\{
00006 
00007     VectorXd sigma\_local = VectorXd::Zero(\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof}*2);
00008 
00009         MatrixXd F = MatrixXd::Zero(\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof},\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof}); \textcolor{comment}{// deformation gradient}
00010         F = \hyperlink{functions_8h_ae50379f74802347e04dbc022897f9cb0}{fe\_calDefGrad}(dndx,dndy,dndz,u);
00011         \textcolor{keywordtype}{double} defJacobian = F.determinant();
00012 
00013         \textcolor{comment}{// fe\_display\_matrix(F);}
00014 
00015         MatrixXd I = MatrixXd::Identity(\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof},\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof});
00016 
00017         MatrixXd B = MatrixXd::Zero(\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof},\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof}); \textcolor{comment}{// Left Cauchy-Green Deformation Tensor}
00018         B = F*F.transpose();
00019         EigenSolver<MatrixXd> es(B);
00020 
00021         MatrixXd D = es.pseudoEigenvalueMatrix();
00022         MatrixXd V = es.pseudoEigenvectors();
00023 
00024         \textcolor{keywordtype}{double} l\_1 = D(0,0);
00025         \textcolor{keywordtype}{double} l\_2 = D(1,1);
00026         \textcolor{keywordtype}{double} l\_3 = D(2,2);
00027 
00028         VectorXd n\_1 = VectorXd::Zero(3);
00029         n\_1 << V(0,0), V(1,0), V(2,0);
00030         VectorXd n\_2 = VectorXd::Zero(3);
00031         n\_2 << V(0,1), V(1,1), V(2,1);
00032         VectorXd n\_3 = VectorXd::Zero(3);
00033         n\_3 << V(0,2), V(1,2), V(2,2);
00034 
00035 
00036         \textcolor{keywordtype}{double} D\_1 = \hyperlink{functions_8h_af7ffbad6dfcc99fc88b130c1a7b1720a}{fe\_get\_mats}(3,1)/2;
00037         \textcolor{keywordtype}{double} p = -2*D\_1*(defJacobian-1);
00038 
00039         \textcolor{keywordtype}{double} n = \hyperlink{functions_8h_af7ffbad6dfcc99fc88b130c1a7b1720a}{fe\_get\_mats}(opt,3);
00040         \textcolor{keywordtype}{int} counter = 4;
00041         \textcolor{keywordtype}{double} W\_1 = 0;
00042         \textcolor{keywordtype}{double} W\_2 = 0;
00043         \textcolor{keywordtype}{double} W\_3 = 0;
00044         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{double} i=0.0;i<n;)\{
00045             \textcolor{keywordtype}{double} mu = \hyperlink{functions_8h_af7ffbad6dfcc99fc88b130c1a7b1720a}{fe\_get\_mats}(opt,counter);
00046             \textcolor{keywordtype}{double} alpha = \hyperlink{functions_8h_af7ffbad6dfcc99fc88b130c1a7b1720a}{fe\_get\_mats}(3,counter+1);
00047             W\_1 = W\_1 + (mu*pow(l\_1,(alpha-1)));
00048             W\_2 = W\_2 + (mu*pow(l\_2,(alpha-1)));
00049             W\_3 = W\_3 + (mu*pow(l\_3,(alpha-1)));
00050             i = i+1.0;
00051             counter = counter+2;
00052         \}
00053         MatrixXd cauchy\_sigma = MatrixXd::Zero(\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof},\hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof});
00054 
00055         cauchy\_sigma = -p*I + (l\_1/(l\_1*l\_2*l\_3))*W\_1*(n\_1*(n\_1.transpose())) + (l\_2/(l\_1*l\_2*l\_3))*W\_2*(
      n\_2*(n\_2.transpose())) + (l\_3/(l\_1*l\_2*l\_3))*W\_3*(n\_3*(n\_3.transpose()));
00056 
00057         MatrixXd pk\_S = MatrixXd::Zero(3,3);
00058         MatrixXd F\_inv = F.inverse();
00059         pk\_S = defJacobian*F\_inv*cauchy\_sigma*F\_inv.transpose();
00060 
00061         sigma\_local = \hyperlink{functions_8h_a73c4523ec7068af2af9e8431021f5fdf}{fe\_tensor2voigt}(pk\_S);
00062 
00063         \textcolor{keywordflow}{if}(return\_opt==1)\{
00064             sigma\_local = \hyperlink{functions_8h_a73c4523ec7068af2af9e8431021f5fdf}{fe\_tensor2voigt}(cauchy\_sigma);
00065         \}
00066 
00067     \textcolor{keywordflow}{return} sigma\_local;
00068 \}
00069 
\end{DoxyCode}

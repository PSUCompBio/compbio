\hypertarget{fe__stiffness__hex_8cpp_source}{}\section{fe\+\_\+stiffness\+\_\+hex.\+cpp}
\label{fe__stiffness__hex_8cpp_source}\index{src/eema/src/\+Elements/\+Internal\+Nodal\+Force/fe\+\_\+stiffness\+\_\+hex.\+cpp@{src/eema/src/\+Elements/\+Internal\+Nodal\+Force/fe\+\_\+stiffness\+\_\+hex.\+cpp}}

\begin{DoxyCode}
00001 
00002 
00003 \textcolor{preprocessor}{#include"\hyperlink{functions_8h}{functions.h}"}
00004 
00005 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00006 
\Hypertarget{fe__stiffness__hex_8cpp_source_l00007}\hyperlink{fe__stiffness__hex_8cpp_a9378d4fc517465015411134456235a76}{00007} MatrixXd \hyperlink{fe__stiffness__hex_8cpp_a9378d4fc517465015411134456235a76}{fe\_stiffness\_hex}(\textcolor{keywordtype}{double} E, \textcolor{keywordtype}{double} nu, \textcolor{keywordtype}{int} \hyperlink{_global_variables_8h_aa789fe4d8a13fd0990b630909430d5d0}{ndof}, \textcolor{keywordtype}{int} nnel, \textcolor{keywordtype}{int} edof, \textcolor{keywordtype}{double} 
      xcoord[], \textcolor{keywordtype}{double} ycoord[], \textcolor{keywordtype}{double} zcoord[])\{
00008 
00009     \textcolor{keywordtype}{int} nglx = 2;
00010     \textcolor{keywordtype}{int} ngly = 2;
00011     \textcolor{keywordtype}{int} nglz = 2;
00012 
00013     MatrixXd k(edof,edof); \textcolor{comment}{// element stiffness matrix  }
00014     k = MatrixXd::Zero(edof,edof);
00015 
00016     MatrixXd disp\_mat(6,edof);
00017 
00018     MatrixXd matl\_mat(6,6);
00019     matl\_mat = fe\_isoElastic(4,E,nu);
00020 
00021     VectorXd shapes\_3d(edof);
00022     VectorXd dndr(edof);    
00023     VectorXd dnds(edof);
00024     VectorXd dndt(edof);
00025     VectorXd dndx(edof);    
00026     VectorXd dndy(edof);
00027     VectorXd dndz(edof);
00028     MatrixXd jacobian(edof,edof);
00029     MatrixXd invJacobian(edof,edof);
00030 
00031     MatrixXd points\_3d = \hyperlink{functions_8h_a502e3469e1cc253deb142f46c0789a78}{guass\_points\_3d}(nglx,ngly,nglz);
00032     MatrixXd weights\_3d = \hyperlink{functions_8h_ad99b08ce65ae353e91486d7685c22024}{guass\_weights\_3d}(ndof,nglx,ngly,nglz);
00033 
00034     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} intx=0;intx<nglx;intx++)\{
00035         \textcolor{keywordtype}{double} x = points\_3d(0,intx);
00036         \textcolor{keywordtype}{double} wtx = weights\_3d(0,intx);
00037         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} inty=0;inty<ngly;inty++)\{
00038             \textcolor{keywordtype}{double} y = points\_3d(1,inty);
00039             \textcolor{keywordtype}{double} wty = weights\_3d(1,inty); 
00040             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} intz=0;intz<nglz;intz++)\{
00041                 \textcolor{keywordtype}{double} z = points\_3d(2,intz);
00042                 \textcolor{keywordtype}{double} wtz = weights\_3d(2,intz);
00043                 
00044                 std::cout<<\textcolor{stringliteral}{"I am here\(\backslash\)n"};
00045 
00046                 \textcolor{comment}{//VectorXd shapes\_3d(edof);}
00047                 shapes\_3d = \hyperlink{functions_8h_ab77a3a6d6f6b436d7e8c600bb0869927}{fe\_shapes\_8}(x,y,z);
00048                 \textcolor{comment}{//VectorXd dndr(edof);}
00049                 dndr = \hyperlink{functions_8h_afc547bef246c057db6cbd04bf7f866a9}{fe\_dndr\_8}(x,y,z);
00050                 \textcolor{comment}{//VectorXd dnds(edof);}
00051                 dnds = \hyperlink{functions_8h_ac0b5524525e1f2e89bb064c15ab8e664}{fe\_dnds\_8}(x,y,z);
00052                 \textcolor{comment}{//VectorXd dndt(edof);}
00053                 dndt = \hyperlink{functions_8h_a57e8e5c9f740c98e4767f29c121c2d0a}{fe\_dndt\_8}(x,y,z);
00054 
00055                 \textcolor{comment}{//MatrixXd jacobian(ndof,ndof);}
00056                 jacobian = \hyperlink{functions_8h_a5ae3771e65b4a0d177097041a4349c28}{fe\_calJacobian}(ndof,nnel,dndr,dnds,dndt,xcoord,ycoord,zcoord);
00057                 \textcolor{keywordtype}{double} detJacobian = jacobian.determinant();
00058                 \textcolor{comment}{//MatrixXd invJacobian(ndof,ndof);}
00059                 invJacobian = jacobian.inverse();
00060 
00061                 \textcolor{comment}{//VectorXd dndx(edof);}
00062                 dndx = \hyperlink{functions_8h_afc6be1a5667e68156cb099e8da71170f}{fe\_dndx\_8}(nnel, dndr, dnds, dndt, invJacobian);
00063                 \textcolor{comment}{//VectorXd dndy(edof);}
00064                 dndy = \hyperlink{functions_8h_a0572d7818e085c67f7fbb84eef8ecfb4}{fe\_dndy\_8}(nnel, dndr, dnds, dndt, invJacobian);
00065                 \textcolor{comment}{//VectorXd dndz(edof);}
00066                 dndz = \hyperlink{functions_8h_aaf75db8433433807839c6ea17f2cf72c}{fe\_dndz\_8}(nnel, dndr, dnds, dndt, invJacobian);
00067 
00068                 
00069                 disp\_mat = \hyperlink{functions_8h_a4b49d2df4f86e7d0755971ab4bfa48b2}{fe\_strDispMatrix}(edof,nnel,dndx,dndy,dndz);
00070                 k = k + (((disp\_mat.transpose())*matl\_mat*disp\_mat)*wtx*wty*wtz*detJacobian);
00071                 \textcolor{comment}{//std::cout<<k<<std::endl;}
00072             \}
00073         \}
00074     \}
00075     
00076     \textcolor{keywordflow}{return} k;
00077 \}   
\end{DoxyCode}

\hypertarget{fe__compute__host_8cpp_source}{}\section{fe\+\_\+compute\+\_\+host.\+cpp}
\label{fe__compute__host_8cpp_source}\index{src/eema/src/\+F\+E\+M/\+Constraints/\+Embedded\+Element/fe\+\_\+compute\+\_\+host.\+cpp@{src/eema/src/\+F\+E\+M/\+Constraints/\+Embedded\+Element/fe\+\_\+compute\+\_\+host.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{functions_8h}{functions.h}"}
00002 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00003 
\Hypertarget{fe__compute__host_8cpp_source_l00004}\hyperlink{fe__compute__host_8cpp_a453ba6bc1e7d5a63db9d56beb6077a27}{00004} \textcolor{keywordtype}{int} \hyperlink{fe__compute__host_8cpp_a453ba6bc1e7d5a63db9d56beb6077a27}{fe\_compute\_host}(VectorXd A, MatrixXd nodes\_host, MatrixXd elements\_host\_tmp)\{
00005 
00006     \textcolor{keywordtype}{int} host\_id;
00007 
00008     MatrixXi faces = MatrixXi::Zero(12,3);
00009     faces << 0, 1, 2,
00010             2, 3, 0,
00011             4, 5, 6,
00012             6, 7, 4,
00013             4, 5, 1,
00014             1, 0, 4,
00015             2, 6, 7,
00016             7, 3, 2,
00017             1, 5, 6,
00018             6, 2, 1,
00019             4, 0, 3,
00020             3, 7, 4;
00021 
00022     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<elements\_host\_tmp.rows();i++)\{
00023         \textcolor{keywordtype}{int} counter = 0;
00024         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<faces.rows();j++)\{
00025             \textcolor{keywordtype}{int} i\_1, i\_2, i\_3;
00026             i\_1 = \hyperlink{functions_8h_a983304137f9a961469a558437d5d2d59}{fe\_find}(nodes\_host,element\_host\_tmp.rows((faces(j,0))+2));
00027             i\_2 = \hyperlink{functions_8h_a983304137f9a961469a558437d5d2d59}{fe\_find}(nodes\_host,element\_host\_tmp.rows((faces(j,1))+2));
00028             i\_3 = \hyperlink{functions_8h_a983304137f9a961469a558437d5d2d59}{fe\_find}(nodes\_host,element\_host\_tmp.rows((faces(j,2))+2));
00029 
00030             VectorXd center;
00031             center << ((nodes\_host(i\_1,1)+nodes\_host(i\_2,1)+nodes\_host(i\_3,1))/3), ((nodes\_host(i\_1,2)+
      nodes\_host(i\_2,2)+nodes\_host(i\_3,2))/3), ((nodes\_host(i\_1,3)+nodes\_host(i\_2,3)+nodes\_host(i\_3,3))/3) ;
00032 
00033             VectorXd edge\_1;
00034             VectorXd edge\_2;
00035             edge\_1 << (nodes\_host(i\_1,1)-nodes\_host(i\_2,1)), (nodes\_host(i\_1,2)-nodes\_host(i\_2,2)), (
      nodes\_host(i\_1,3)-nodes\_host(i\_2,3));
00036             edge\_2 << (nodes\_host(i\_3,1)-nodes\_host(i\_2,1)), (nodes\_host(i\_3,2)-nodes\_host(i\_2,2)), (
      nodes\_host(i\_3,3)-nodes\_host(i\_2,3)); 
00037 
00038             VectorXd normal;
00039             normal = edge\_1.cross(edge\_2);
00040 
00041             VectorXd center\_normal = (center(0) - A(1)), (center(1) - A(2)), (center(2) - A(3));
00042 
00043             \textcolor{keywordtype}{double} angle = center\_normal.dot(normal);
00044 
00045             \textcolor{keywordflow}{if}(angle < 0) \textcolor{keywordflow}{break};
00046 
00047             counter = counter + 1;
00048         \}
00049 
00050         \textcolor{keywordflow}{if}(counter==12)\{
00051             host\_id = elements\_host\_tmp(i,0);
00052             \textcolor{keywordflow}{break};
00053         \}
00054     \}
00055 
00056     \textcolor{keywordflow}{return} host\_id;
00057 
00058 \}
\end{DoxyCode}

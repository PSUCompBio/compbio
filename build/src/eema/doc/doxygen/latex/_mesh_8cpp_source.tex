\hypertarget{_mesh_8cpp_source}{}\section{Mesh.\+cpp}
\label{_mesh_8cpp_source}\index{src/eema/src/\+Input-\/\+Output/\+Input/\+Mesh.\+cpp@{src/eema/src/\+Input-\/\+Output/\+Input/\+Mesh.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{functions_8h}{functions.h}"}
00002 \textcolor{preprocessor}{#include "\hyperlink{_mesh_8h}{Mesh.h}"}
00003 
00004 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00005 
\Hypertarget{_mesh_8cpp_source_l00006}\hyperlink{class_mesh_aba57df50d740f660cadf00aefe75e157}{00006} \textcolor{keywordtype}{void} \hyperlink{class_mesh_aba57df50d740f660cadf00aefe75e157}{Mesh::readMesh}(MatrixXd n, MatrixXi e)\{
00007     nodes = n;
00008     elements = e;
00009 \}
00010 
\Hypertarget{_mesh_8cpp_source_l00011}\hyperlink{class_mesh_a0b0f7458f07745240d9bda967cda12de}{00011} MatrixXd \hyperlink{class_mesh_a0b0f7458f07745240d9bda967cda12de}{Mesh::getNodes}(\textcolor{keywordtype}{void})\{
00012     \textcolor{keywordflow}{return} nodes;
00013 \}
00014 
\Hypertarget{_mesh_8cpp_source_l00015}\hyperlink{class_mesh_a4828631f942fd5a701870beea870f413}{00015} MatrixXi \hyperlink{class_mesh_a4828631f942fd5a701870beea870f413}{Mesh::getElements}(\textcolor{keywordtype}{void})\{
00016     \textcolor{keywordflow}{return} elements;
00017 \}
00018 
\Hypertarget{_mesh_8cpp_source_l00019}\hyperlink{class_mesh_a52ecce406bbef80cbf3610db3ea5ea40}{00019} MatrixXd \hyperlink{class_mesh_a52ecce406bbef80cbf3610db3ea5ea40}{Mesh::getNewNodes}(\textcolor{keywordtype}{void})\{
00020     \textcolor{keywordflow}{return} nodes\_new;
00021 \}
00022 
\Hypertarget{_mesh_8cpp_source_l00023}\hyperlink{class_mesh_a6e425e9499e64ab52c4555aa3763651d}{00023} MatrixXi \hyperlink{class_mesh_a6e425e9499e64ab52c4555aa3763651d}{Mesh::getNewElements}(\textcolor{keywordtype}{void})\{
00024     \textcolor{keywordflow}{return} elements\_new;
00025 \}
00026 
\Hypertarget{_mesh_8cpp_source_l00027}\hyperlink{class_mesh_a2193a797388525febbac794d17bea23e}{00027} \textcolor{keywordtype}{void} \hyperlink{class_mesh_a2193a797388525febbac794d17bea23e}{Mesh::readNodalKinematics}(VectorXd Usystem, VectorXd Vsystem, VectorXd 
      Asystem)\{
00028     U = Usystem;
00029     V = Vsystem;
00030     A = Asystem;
00031 \}
00032 
\Hypertarget{_mesh_8cpp_source_l00033}\hyperlink{class_mesh_a3fbc4b3c21f738efc6cdf3d02e31ad23}{00033} VectorXd \hyperlink{class_mesh_a3fbc4b3c21f738efc6cdf3d02e31ad23}{Mesh::getNodalDisp}(\textcolor{keywordtype}{void})\{
00034     \textcolor{keywordflow}{return} U;
00035 \}
00036 
\Hypertarget{_mesh_8cpp_source_l00037}\hyperlink{class_mesh_a052cd330cb8ccecf63e960a7afd0a6d9}{00037} VectorXd \hyperlink{class_mesh_a052cd330cb8ccecf63e960a7afd0a6d9}{Mesh::getNodalVel}(\textcolor{keywordtype}{void})\{
00038     \textcolor{keywordflow}{return} V;
00039 \}
00040 
\Hypertarget{_mesh_8cpp_source_l00041}\hyperlink{class_mesh_ad41670edd4e6335071012837a58fb725}{00041} VectorXd \hyperlink{class_mesh_ad41670edd4e6335071012837a58fb725}{Mesh::getNodalAcc}(\textcolor{keywordtype}{void})\{
00042     \textcolor{keywordflow}{return} A;
00043 \}
00044 
\Hypertarget{_mesh_8cpp_source_l00045}\hyperlink{class_mesh_a2c1456f1b3b5bda8d213624e3943dbb3}{00045} \textcolor{keywordtype}{void} \hyperlink{class_mesh_a2c1456f1b3b5bda8d213624e3943dbb3}{Mesh::readStressStrain}(MatrixXd stress\_tmp, MatrixXd strain\_tmp)\{
00046     stress = stress\_tmp;
00047     strain = strain\_tmp;
00048 \}
00049 
\Hypertarget{_mesh_8cpp_source_l00050}\hyperlink{class_mesh_a4ec62fd7219adcd406a167c1f6ee81e8}{00050} MatrixXd \hyperlink{class_mesh_a4ec62fd7219adcd406a167c1f6ee81e8}{Mesh::getCellStress}()\{
00051     \textcolor{keywordflow}{return} stress;
00052 \}
00053 
\Hypertarget{_mesh_8cpp_source_l00054}\hyperlink{class_mesh_a1c54802401d00d14b390db2f0e615ebb}{00054} MatrixXd \hyperlink{class_mesh_a1c54802401d00d14b390db2f0e615ebb}{Mesh::getCellStrain}()\{
00055     \textcolor{keywordflow}{return} strain;
00056 \}
00057 
\Hypertarget{_mesh_8cpp_source_l00058}\hyperlink{class_mesh_aa8a6f260e9589be4c0a2fcc146e696d5}{00058} \textcolor{keywordtype}{void} \hyperlink{class_mesh_aa8a6f260e9589be4c0a2fcc146e696d5}{Mesh::preprocessMesh}(\textcolor{keywordtype}{void})\{
00059 
00060     nodes\_new = nodes;
00061     elements\_new = elements;
00063     \textcolor{comment}{/* for(int i=0;i<nodes.rows();i++)\{}
00064 \textcolor{comment}{        nodes\_new(i,0) = i;}
00065 \textcolor{comment}{    \} */}
00067     \textcolor{comment}{/* for(int i=0;i<elements.rows();i++)\{}
00068 \textcolor{comment}{        elements\_new(i,0) = i;}
00069 \textcolor{comment}{        elements\_new(i,1) = elements(i,1);}
00070 \textcolor{comment}{        for(int j=2;j<elements.cols();j++)\{}
00071 \textcolor{comment}{            elements\_new(i,j) = fe\_find(nodes.col(0),elements(i,j));}
00072 \textcolor{comment}{        \}}
00073 \textcolor{comment}{    \}*/}
00074 \}
00075 
\Hypertarget{_mesh_8cpp_source_l00076}\hyperlink{class_mesh_af03b49cbaf762652c9ff5ff7f4a6e668}{00076} \textcolor{keywordtype}{void} \hyperlink{class_mesh_af03b49cbaf762652c9ff5ff7f4a6e668}{Mesh::replaceNodes}(MatrixXd new\_nodes, std::string choice)\{
00077     \textcolor{keywordflow}{if}(choice==\textcolor{stringliteral}{"old"})\{
00078         nodes = new\_nodes;
00079     \}
00080     \textcolor{keywordflow}{else}
00081     \{
00082         nodes\_new = new\_nodes;
00083     \}
00084 \}
00085 
\Hypertarget{_mesh_8cpp_source_l00086}\hyperlink{class_mesh_a95ba7a96ec42ea4e0c191890f7faa2ab}{00086} \textcolor{keywordtype}{void} \hyperlink{class_mesh_a95ba7a96ec42ea4e0c191890f7faa2ab}{Mesh::replaceElements}(MatrixXi new\_elements, std::string choice)\{
00087     \textcolor{keywordflow}{if}(choice==\textcolor{stringliteral}{"old"})\{
00088         elements = new\_elements;
00089     \}
00090     \textcolor{keywordflow}{else}
00091     \{
00092         elements\_new = new\_elements;
00093     \}
00094 \}
00095 
\Hypertarget{_mesh_8cpp_source_l00097}\hyperlink{class_mesh_a94ce58cb2598b1db2973ad357dae2710}{00097} VectorXd \hyperlink{class_mesh_a94ce58cb2598b1db2973ad357dae2710}{Mesh::getMinCharLength}(std::string choice)\{
00098 
00099     VectorXd min\_details;
00100 
00101     MatrixXd nodes\_local;
00102     MatrixXi elements\_local;
00103 
00104     \textcolor{keywordflow}{if}(choice==\textcolor{stringliteral}{"old"})\{
00105         nodes\_local = nodes;
00106         elements\_local = elements;
00107     \}
00108     \textcolor{keywordflow}{else}
00109     \{
00110         nodes\_local = nodes\_new;
00111         elements\_local = elements\_new;
00112     \}
00113 
00114     VectorXd xcoord;
00115     VectorXd ycoord;
00116     VectorXd zcoord;
00117     \textcolor{keywordtype}{double} min\_length = 10000000;
00118     \textcolor{keywordtype}{double} \textcolor{keywordtype}{id} = 0;
00119     \textcolor{keywordtype}{double} lc;
00120 
00121     xcoord = VectorXd::Zero(elements\_local.cols()-2);
00122     ycoord = VectorXd::Zero(elements\_local.cols()-2);
00123     zcoord = VectorXd::Zero(elements\_local.cols()-2);
00124     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<elements\_local.rows();i++)\{
00125         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<(elements\_local.cols()-2);j++)\{
00126             \textcolor{keywordtype}{int} g = -1;
00127             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} f=0;f<nodes\_local.rows();f++)\{
00128                 \textcolor{keywordflow}{if}(elements\_local(i,j+2)==nodes\_local(f,0))\{
00129                     g = f;
00130                     \textcolor{keywordflow}{break};
00131                 \}
00132             \}
00133             xcoord[j] = nodes\_local(g,1);
00134             ycoord[j] = nodes\_local(g,2);
00135             zcoord[j] = nodes\_local(g,3);
00136         \}
00137 
00138         lc = \hyperlink{functions_8h_a6b04cfa4d2533eed9667ae14f361baa6}{fe\_minElementLength}(xcoord,ycoord,zcoord);
00139 
00140         \textcolor{keywordflow}{if}(lc<min\_length)\{
00141             min\_length = lc;
00142             \textcolor{keywordtype}{id} = i;
00143         \}
00144 
00145     \}
00146 
00147     min\_details << min\_length,id;
00148 
00149     \textcolor{keywordflow}{return} min\_details;
00150 \}
00151 
\Hypertarget{_mesh_8cpp_source_l00153}\hyperlink{class_mesh_a72d2a3863b85a2a2aed7deca8ce37832}{00153} VectorXd \hyperlink{class_mesh_a72d2a3863b85a2a2aed7deca8ce37832}{Mesh::getMaxCharLength}(std::string choice)\{
00154 
00155     VectorXd max\_details;
00156     \textcolor{keywordtype}{double} id;
00157 
00158     MatrixXd nodes\_local;
00159     MatrixXi elements\_local;
00160 
00161     \textcolor{keywordflow}{if}(choice==\textcolor{stringliteral}{"old"})\{
00162         nodes\_local = nodes;
00163         elements\_local = elements;
00164     \}
00165     \textcolor{keywordflow}{else}
00166     \{
00167         nodes\_local = nodes\_new;
00168         elements\_local = elements\_new;
00169     \}
00170 
00171     VectorXd xcoord;
00172     VectorXd ycoord;
00173     VectorXd zcoord;
00174     \textcolor{keywordtype}{double} max\_length = 0.0;
00175     \textcolor{keywordtype}{double} lc;
00176 
00177     xcoord = VectorXd::Zero(elements\_local.cols()-2);
00178     ycoord = VectorXd::Zero(elements\_local.cols()-2);
00179     zcoord = VectorXd::Zero(elements\_local.cols()-2);
00180     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0;i<elements\_local.rows();i++)\{
00181         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<(elements\_local.cols()-2);j++)\{
00182             \textcolor{keywordtype}{int} g = -1;
00183             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} f=0;f<nodes\_local.rows();f++)\{
00184                 \textcolor{keywordflow}{if}(elements\_local(i,j+2)==nodes\_local(f,0))\{
00185                     g = f;
00186                     \textcolor{keywordflow}{break};
00187                 \}
00188             \}
00189             xcoord[j] = nodes\_local(g,1);
00190             ycoord[j] = nodes\_local(g,2);
00191             zcoord[j] = nodes\_local(g,3);
00192         \}
00193 
00194         lc = \hyperlink{functions_8h_aa11bdbf370d88d267313624c85c28e70}{fe\_maxElementLength}(xcoord,ycoord,zcoord);
00195 
00196         \textcolor{keywordflow}{if}(lc>max\_length)\{
00197             max\_length = lc;
00198             \textcolor{keywordtype}{id} = i;
00199         \}
00200 
00201     \}
00202 
00203     max\_details << max\_length, id;
00204     \textcolor{keywordflow}{return} max\_details;
00205 \}
00206 
\Hypertarget{_mesh_8cpp_source_l00208}\hyperlink{class_mesh_a894e41dd4280dfba75406eb8d0338a8e}{00208} \textcolor{keywordtype}{void} \hyperlink{class_mesh_a894e41dd4280dfba75406eb8d0338a8e}{Mesh::checkMesh}()\{
00209     VectorXd lc;
00210 
00211     lc = getMinCharLength(\textcolor{stringliteral}{"new"});
00212 
00213     \textcolor{keywordflow}{if}(lc(0) == 0)\{
00214         std::cout << \textcolor{stringliteral}{"**********************************************"} << std::endl;
00215         std::cout << \textcolor{stringliteral}{"ZERO LENGTH ELEMENT IN THE SYSTEM \(\backslash\)n FIBER LENGTH PREPROCESSING NOT POSSIBLE"} << 
      std::endl;
00216         std::cout << \textcolor{stringliteral}{"**********************************************"} << std::endl;
00217         std::exit(-1);
00218     \}
00219 
00220 \}
\end{DoxyCode}

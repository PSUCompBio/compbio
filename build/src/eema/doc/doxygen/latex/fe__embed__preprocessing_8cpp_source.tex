\hypertarget{fe__embed__preprocessing_8cpp_source}{}\section{fe\+\_\+embed\+\_\+preprocessing.\+cpp}
\label{fe__embed__preprocessing_8cpp_source}\index{src/eema/src/\+F\+E\+M/\+Constraints/\+Embedded\+Element/fe\+\_\+embed\+\_\+preprocessing.\+cpp@{src/eema/src/\+F\+E\+M/\+Constraints/\+Embedded\+Element/fe\+\_\+embed\+\_\+preprocessing.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "\hyperlink{functions_8h}{functions.h}"}
00002 
00003 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00004 
\Hypertarget{fe__embed__preprocessing_8cpp_source_l00007}\hyperlink{fe__embed__preprocessing_8cpp_a840ddc7df1916f6b5dfbb141adac32d3}{00007} VectorXd \hyperlink{fe__embed__preprocessing_8cpp_a840ddc7df1916f6b5dfbb141adac32d3}{fe\_embed\_preprocessing}(\hyperlink{class_mesh}{Mesh} host,\hyperlink{class_mesh}{Mesh} embed)\{
00008 
00009     \hyperlink{fe__embed__preprocessing_8cpp_a50e8d7839525058d40e3a53f9d5de77c}{fe\_embed\_preprocessing\_length}(host,embed);
00010 
00011 \}
00012 
\Hypertarget{fe__embed__preprocessing_8cpp_source_l00013}\hyperlink{fe__embed__preprocessing_8cpp_a50e8d7839525058d40e3a53f9d5de77c}{00013} \textcolor{keywordtype}{void} \hyperlink{fe__embed__preprocessing_8cpp_a50e8d7839525058d40e3a53f9d5de77c}{fe\_embed\_preprocessing\_length}(\hyperlink{class_mesh}{Mesh} host, 
      \hyperlink{class_mesh}{Mesh} embed)\{
00014 
00016     host.\hyperlink{class_mesh_a894e41dd4280dfba75406eb8d0338a8e}{checkMesh}();
00018     embed.\hyperlink{class_mesh_a894e41dd4280dfba75406eb8d0338a8e}{checkMesh}();
00019 
00020     VectorXd lc\_host = host.\hyperlink{class_mesh_a94ce58cb2598b1db2973ad357dae2710}{getMinCharLength}(\textcolor{stringliteral}{"new"});
00021     VectorXd lc\_embed = embed.\hyperlink{class_mesh_a72d2a3863b85a2a2aed7deca8ce37832}{getMaxCharLength}(\textcolor{stringliteral}{"new"});
00022 
00023     MatrixXd nodes\_local;
00024     MatrixXi elements\_local;
00025 
00026     \textcolor{keywordflow}{while} (lc\_embed(0) > lc\_host(0))\{
00027 
00028         nodes\_local = embed.\hyperlink{class_mesh_a52ecce406bbef80cbf3610db3ea5ea40}{getNewNodes}();
00029         elements\_local = embed.\hyperlink{class_mesh_a6e425e9499e64ab52c4555aa3763651d}{getNewElements}();
00030 
00031         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<elements\_local.rows();i++)\{
00032 
00033             \textcolor{keywordflow}{if}(i==(\textcolor{keywordtype}{int})lc\_embed(1))\{
00034                  \textcolor{keywordtype}{int} i\_1 = \hyperlink{functions_8h_a983304137f9a961469a558437d5d2d59}{fe\_find}(nodes\_local.col(0),elements\_local(i,2));
00035                  \textcolor{keywordtype}{int} i\_2 = \hyperlink{functions_8h_a983304137f9a961469a558437d5d2d59}{fe\_find}(nodes\_local.col(0),elements\_local(i,3));
00036                  
00037                  VectorXd mid\_point;
00038                  mid\_point << ((nodes\_local(i\_1,1)+nodes\_local(i\_2,1))/2) , ((nodes\_local(i\_1,2)+
      nodes\_local(i\_2,2))/2), ((nodes\_local(i\_1,3)+nodes\_local(i\_2,3))/2);
00039                 
00040                 \textcolor{keywordtype}{int} new\_node\_num = nodes\_local((nodes\_local.rows()-1),0) + 1 ;
00041                 VectorXd new\_node;
00042                 new\_node << new\_node\_num, mid\_point(0), mid\_point(1), mid\_point(2);
00043                 nodes\_local = \hyperlink{functions_8h_ac2d90cb6719488bc8551e6f9437f4f76}{fe\_concatenate\_vector2matrix}(nodes\_local,new\_node
      ,1);
00044                 elements\_local(i,3) = new\_node\_num;
00045                 
00046                 VectorXd new\_element;
00047                 new\_element << 0, new\_node\_num, i\_2;
00048                 elements\_local = \hyperlink{functions_8h_a94d7770f842e44e01a47ae5624bd7749}{fe\_insert\_vector2matrix}(elements\_local,new\_element,
      i,1);
00049 
00050                 embed.\hyperlink{class_mesh_a95ba7a96ec42ea4e0c191890f7faa2ab}{replaceElements}(elements\_local,\textcolor{stringliteral}{"old"});
00051                 embed.\hyperlink{class_mesh_af03b49cbaf762652c9ff5ff7f4a6e668}{replaceNodes}(nodes\_local,\textcolor{stringliteral}{"old"});
00052                 embed.\hyperlink{class_mesh_aa8a6f260e9589be4c0a2fcc146e696d5}{preprocessMesh}();
00053 
00054                 lc\_embed = embed.\hyperlink{class_mesh_a72d2a3863b85a2a2aed7deca8ce37832}{getMaxCharLength}(\textcolor{stringliteral}{"new"});
00055 
00056             \}
00057 
00058         \}
00059 
00060     \}
00061 
00062 \}
00063 
\end{DoxyCode}
